{"id":"components/Home.vue","dependencies":[{"name":"/data/uibuilder/navbar/package.json","includedInParent":true,"mtime":1654946937447},{"name":"./Widget.vue","loc":{"line":137,"column":19,"index":421},"parent":"/data/uibuilder/navbar/src/components/Home.vue","resolved":"/data/uibuilder/navbar/src/components/Widget.vue"},{"name":"_css_loader","parent":"/data/uibuilder/navbar/src/components/Home.vue","resolved":"/data/uibuilder/navbar/node_modules/parcel-bundler/src/builtins/css-loader.js"},{"name":"vue-hot-reload-api","parent":"/data/uibuilder/navbar/src/components/Home.vue","resolved":"/data/uibuilder/navbar/node_modules/vue-hot-reload-api/dist/index.js"},{"name":"vue","parent":"/data/uibuilder/navbar/src/components/Home.vue","resolved":"/data/uibuilder/navbar/node_modules/vue/dist/vue.runtime.esm.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Widget = _interopRequireDefault(require(\"./Widget.vue\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: \"home\",\n  components: {\n    Widget: _Widget.default\n  },\n  data: function data() {\n    return {\n      sidebarToggle: 0,\n      estado: \"\",\n      piezas_ok: 0,\n      Signals: [],\n      widgets: [],\n      layout: [],\n      add_widget_step: 0,\n      new_widget: {},\n      timesteps: \"2h\",\n      gridindex: 1 // msg: \"No Message Received from Node-Red\",\n\n    };\n  },\n  methods: {\n    addWidget: function addWidget(signal, event, add) {\n      if (this.add_widget_step == 0) {\n        this.new_widget.SignalID = signal;\n\n        if (this.Signals[signal] > 0) {\n          this.new_widget.alarm = {\n            type: \"danger\",\n            msg: \"Fuera de límites de tolerancia\"\n          };\n        }\n\n        this.add_widget_step = 1;\n      } else if (this.add_widget_step == 1) {\n        // this.new_widget.loading = true;\n        if (signal == \"\") {\n          this.new_widget.type = \"PlotlyGrafica\";\n        } else {\n          this.new_widget.type = signal;\n        }\n\n        this.new_widget.params = {};\n        this.add_widget_step = 2;\n      } else if (this.add_widget_step == 2) {}\n\n      if (add) {\n        this.new_widget.params.timesteps = this.timesteps;\n        this.new_widget.gridindex = this.gridindex;\n        console.log(\"NEW_WIDGET\", this.new_widget);\n        this.layout.push({\n          i: this.gridindex,\n          x: 0,\n          y: 0,\n          w: 12,\n          h: 10\n        });\n        this.gridindex++;\n        this.widgets.push(this.new_widget);\n        this.new_widget = {};\n        this.add_widget_step = 0;\n      }\n    },\n    // TODO: No funciona bien.\n    removeWidget: function removeWidget(index) {\n      var gridindex = this.widgets.map(function (widget) {\n        return widget.gridindex;\n      }).indexOf(index);\n      this.widgets.splice(gridindex, 1);\n      var layoutIndex = this.widgets.map(function (layout) {\n        return layout.i;\n      }).indexOf(index);\n      this.layout.splice(layoutIndex, 1);\n    },\n    expandGrid: function expandGrid() {\n      this.sidebarToggle = 0;\n    },\n    reduceGrid: function reduceGrid() {\n      this.sidebarToggle = 2;\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var fluxQuery = \"\\n      from(bucket: \\\"cel86\\\")\\n        |> range(start: -15m)\\n        |> filter(fn: (r) => r[\\\"_measurement\\\"] == \\\"sensores\\\")\\n        |> filter(fn: (r) => r[\\\"molde\\\"] == \\\"MT201\\\")\\n        |> filter(fn: (r) => r._field == \\\"value\\\" or r._field == \\\"value_max\\\" or r._field == \\\"value_min\\\")\\n        |> pivot(rowKey: [\\\"_time\\\"], columnKey: [\\\"_field\\\"], valueColumn: \\\"_value\\\")\\n        |> map(fn: (r) => ({r with _value: r.value > r.value_max or r.value < r.value_min}))\\n        |> filter(fn: (r) => r._value == true, onEmpty: \\\"keep\\\") \\n        |> count(column: \\\"_value\\\")\\n        |> pivot(rowKey:[\\\"_measurement\\\"], columnKey: [\\\"medicion\\\"], valueColumn: \\\"_value\\\")\\n        |> drop(columns: [\\\"_start\\\", \\\"_stop\\\", \\\"_measurement\\\", \\\"molde\\\"])\\n      \";\n    uibuilder.send({\n      'topic': 'initHome',\n      'payload': \"\",\n      'query': fluxQuery\n    });\n    uibuilder.onChange(\"msg\", function (newMsg) {\n      if (newMsg.topic == \"initHome\") {\n        var response = JSON.parse(newMsg.payload);\n        response = response[0];\n        delete response.result;\n        delete response.table;\n        _this.Signals = response;\n      }\n\n      _this.estado = newMsg.celstate ? \"EN MARCHA\" : \"PARADA\";\n      _this.piezas_ok = newMsg.cel_counter_ok ? \"EN MARCHA\" : \"PARADA\"; // if (newMsg.signal_index) {\n      //   this.Signals = Object.keys(newMsg.signal_index);\n      // }\n    });\n  }\n};\nexports.default = _default;\n        var $b77d75 = exports.default || module.exports;\n      \n      if (typeof $b77d75 === 'function') {\n        $b77d75 = $b77d75.options;\n      }\n    \n        /* template */\n        Object.assign($b77d75, (function () {\n          var render = function () {\n  var this$1 = this\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"b-container\",\n    { staticClass: \"pr-5\", attrs: { fluid: \"\" } },\n    [\n      _c(\n        \"b-sidebar\",\n        {\n          attrs: {\n            id: \"sidebar-1\",\n            shadow: \"\",\n            \"z-index\": \"50\",\n            \"no-header\": \"\",\n          },\n          on: { shown: _vm.reduceGrid, hidden: _vm.expandGrid },\n        },\n        [\n          _c(\n            \"b-card\",\n            { staticClass: \"mb-1\", attrs: { \"no-body\": \"\" } },\n            [\n              _c(\n                \"b-card-header\",\n                { attrs: { \"header-tag\": \"header\", role: \"tab\" } },\n                [\n                  _c(\n                    \"b-button-group\",\n                    [\n                      _c(\n                        \"b-button\",\n                        {\n                          directives: [\n                            {\n                              name: \"b-toggle\",\n                              rawName: \"v-b-toggle.accordion-1\",\n                              modifiers: { \"accordion-1\": true },\n                            },\n                          ],\n                          attrs: {\n                            block: \"\",\n                            disabled: _vm.add_widget_step == 0 ? false : true,\n                            variant: \"light\",\n                          },\n                        },\n                        [\n                          _vm._v(\n                            \"\\n              \" +\n                              _vm._s(\n                                this.add_widget_step > 0\n                                  ? this.new_widget.SignalID\n                                  : \"Señales\"\n                              )\n                          ),\n                        ]\n                      ),\n                      _vm._v(\" \"),\n                      this.add_widget_step > 0\n                        ? _c(\n                            \"b-button\",\n                            {\n                              attrs: { variant: \"light\" },\n                              on: {\n                                click: function () {\n                                  this$1.new_widget = {}\n                                  this$1.add_widget_step = 0\n                                },\n                              },\n                            },\n                            [_c(\"b-icon-x-square\", { attrs: { size: \"1x\" } })],\n                            1\n                          )\n                        : _vm._e(),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n              _vm._v(\" \"),\n              _c(\n                \"b-collapse\",\n                {\n                  attrs: {\n                    id: \"accordion-1\",\n                    visible: \"\",\n                    accordion: \"my-accordion\",\n                    role: \"tabpanel\",\n                    visible: _vm.add_widget_step == 0 ? true : false,\n                  },\n                },\n                [\n                  _c(\n                    \"b-card-body\",\n                    [\n                      _c(\n                        \"b-list-group\",\n                        { attrs: { flush: \"\" } },\n                        _vm._l(_vm.Signals, function (signal, index) {\n                          return _c(\n                            \"b-list-group-item\",\n                            {\n                              staticClass:\n                                \"d-flex justify-content-between align-items-center py-1\",\n                              attrs: { button: \"\", variant: \"light\" },\n                              on: {\n                                click: function ($event) {\n                                  return _vm.addWidget(index, $event)\n                                },\n                              },\n                            },\n                            [\n                              _vm._v(\n                                \"\\n                 \" + _vm._s(index) + \" \"\n                              ),\n                              signal > 0\n                                ? _c(\"b-icon\", {\n                                    attrs: {\n                                      icon: \"exclamation-circle-fill\",\n                                      variant: \"danger\",\n                                    },\n                                  })\n                                : _vm._e(),\n                            ],\n                            1\n                          )\n                        }),\n                        1\n                      ),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"b-card\",\n            { staticClass: \"mb-1\", attrs: { \"no-body\": \"\" } },\n            [\n              _c(\n                \"b-card-header\",\n                { attrs: { \"header-tag\": \"header\", role: \"tab\" } },\n                [\n                  _c(\n                    \"b-button-group\",\n                    [\n                      _c(\n                        \"b-button\",\n                        {\n                          directives: [\n                            {\n                              name: \"b-toggle\",\n                              rawName: \"v-b-toggle.accordion-2\",\n                              modifiers: { \"accordion-2\": true },\n                            },\n                          ],\n                          attrs: {\n                            block: \"\",\n                            disabled: _vm.add_widget_step == 1 ? false : true,\n                            variant: \"light\",\n                          },\n                        },\n                        [\n                          _vm._v(\n                            \" \" +\n                              _vm._s(\n                                this.add_widget_step > 1\n                                  ? this.new_widget.type\n                                  : \"Widgets\"\n                              )\n                          ),\n                        ]\n                      ),\n                      _vm._v(\" \"),\n                      this.add_widget_step > 1\n                        ? _c(\n                            \"b-button\",\n                            {\n                              attrs: { variant: \"light\" },\n                              on: {\n                                click: function () {\n                                  this$1.new_widget = {\n                                    SignalID: this$1.new_widget.SignalID,\n                                  }\n                                  this$1.add_widget_step = 1\n                                },\n                              },\n                            },\n                            [_c(\"b-icon-x-square\", { attrs: { size: \"1x\" } })],\n                            1\n                          )\n                        : _vm._e(),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n              _vm._v(\" \"),\n              _c(\n                \"b-collapse\",\n                {\n                  attrs: {\n                    id: \"accordion-2\",\n                    accordion: \"my-accordion\",\n                    role: \"tabpanel\",\n                    visible: _vm.add_widget_step == 1 ? true : false,\n                  },\n                },\n                [\n                  _c(\n                    \"b-card-body\",\n                    [\n                      _c(\n                        \"b-row\",\n                        [\n                          _c(\n                            \"b-col\",\n                            [\n                              _c(\"b-img\", {\n                                directives: [\n                                  {\n                                    name: \"b-tooltip\",\n                                    rawName: \"v-b-tooltip.hover\",\n                                    modifiers: { hover: true },\n                                  },\n                                ],\n                                attrs: {\n                                  title: \"Plotly Grafica\",\n                                  thumbnail: \"\",\n                                  fluid: \"\",\n                                  src: \"https://img.icons8.com/dusk/64/undefined/line-chart.png\",\n                                  alt: \"Line Chart\",\n                                },\n                                on: {\n                                  click: function ($event) {\n                                    return _vm.addWidget(\n                                      \"PlotlyGrafica\",\n                                      $event\n                                    )\n                                  },\n                                },\n                              }),\n                            ],\n                            1\n                          ),\n                          _vm._v(\" \"),\n                          _c(\n                            \"b-col\",\n                            [\n                              _c(\"b-img\", {\n                                directives: [\n                                  {\n                                    name: \"b-tooltip\",\n                                    rawName: \"v-b-tooltip.hover\",\n                                    modifiers: { hover: true },\n                                  },\n                                ],\n                                attrs: {\n                                  title: \"Medidor\",\n                                  thumbnail: \"\",\n                                  fluid: \"\",\n                                  src: \"https://img.icons8.com/external-vitaliy-gorbachev-lineal-color-vitaly-gorbachev/60/undefined/external-gauge-infographic-elements-vitaliy-gorbachev-lineal-color-vitaly-gorbachev.png\",\n                                  alt: \"Gauge\",\n                                },\n                                on: {\n                                  click: function ($event) {\n                                    return _vm.addWidget(\"Medidor\", $event)\n                                  },\n                                },\n                              }),\n                            ],\n                            1\n                          ),\n                          _vm._v(\" \"),\n                          _c(\n                            \"b-col\",\n                            [\n                              _c(\"b-img\", {\n                                directives: [\n                                  {\n                                    name: \"b-tooltip\",\n                                    rawName: \"v-b-tooltip.hover\",\n                                    modifiers: { hover: true },\n                                  },\n                                ],\n                                attrs: {\n                                  title: \"Apex Grafica\",\n                                  thumbnail: \"\",\n                                  fluid: \"\",\n                                  src: \"https://img.icons8.com/cute-clipart/64/undefined/squiggly-line.png\",\n                                  alt: \"Live Chart\",\n                                },\n                                on: {\n                                  click: function ($event) {\n                                    return _vm.addWidget(\"ApexGrafica\", $event)\n                                  },\n                                },\n                              }),\n                            ],\n                            1\n                          ),\n                        ],\n                        1\n                      ),\n                      _vm._v(\" \"),\n                      _c(\n                        \"b-row\",\n                        [\n                          _c(\n                            \"b-col\",\n                            [\n                              _c(\"b-img\", {\n                                directives: [\n                                  {\n                                    name: \"b-tooltip\",\n                                    rawName: \"v-b-tooltip.hover\",\n                                    modifiers: { hover: true },\n                                  },\n                                ],\n                                attrs: {\n                                  title: \"Echarts Grafica\",\n                                  thumbnail: \"\",\n                                  fluid: \"\",\n                                  src: \"https://img.icons8.com/external-flaticons-lineal-color-flat-icons/64/undefined/external-line-chart-infographic-flaticons-lineal-color-flat-icons-19.png\",\n                                  alt: \"Echarts\",\n                                },\n                                on: {\n                                  click: function ($event) {\n                                    return _vm.addWidget(\n                                      \"EchartsGrafica\",\n                                      $event\n                                    )\n                                  },\n                                },\n                              }),\n                            ],\n                            1\n                          ),\n                        ],\n                        1\n                      ),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"b-card\",\n            { staticClass: \"mb-1\", attrs: { \"no-body\": \"\" } },\n            [\n              _c(\n                \"b-card-header\",\n                { attrs: { \"header-tag\": \"header\", role: \"tab\" } },\n                [\n                  _c(\n                    \"b-button-group\",\n                    [\n                      _c(\n                        \"b-button\",\n                        {\n                          directives: [\n                            {\n                              name: \"b-toggle\",\n                              rawName: \"v-b-toggle.accordion-3\",\n                              modifiers: { \"accordion-3\": true },\n                            },\n                          ],\n                          attrs: {\n                            block: \"\",\n                            disabled: this.add_widget_step ? false : true,\n                            variant: \"light\",\n                          },\n                        },\n                        [_vm._v(\"\\n              Parametros\")]\n                      ),\n                      _vm._v(\" \"),\n                      this.add_widget_step > 2\n                        ? _c(\n                            \"b-button\",\n                            {\n                              attrs: { variant: \"light\" },\n                              on: {\n                                click: function () {\n                                  this$1.new_widget = {\n                                    SignalID: this$1.new_widget.SignalID,\n                                    type: this$1.new_widget.type,\n                                  }\n                                  this$1.add_widget_step = 2\n                                },\n                              },\n                            },\n                            [_c(\"b-icon-x-square\", { attrs: { size: \"1x\" } })],\n                            1\n                          )\n                        : _vm._e(),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n              _vm._v(\" \"),\n              _c(\n                \"b-collapse\",\n                {\n                  attrs: {\n                    id: \"accordion-3\",\n                    accordion: \"my-accordion\",\n                    role: \"tabpanel\",\n                    visible: _vm.add_widget_step == 2 ? true : false,\n                  },\n                },\n                [\n                  _c(\n                    \"b-card-body\",\n                    [\n                      this.new_widget.type == \"PlotlyGrafica\" ||\n                      this.new_widget.type == \"EchartsGrafica\"\n                        ? _c(\n                            \"b-form-group\",\n                            {\n                              attrs: {\n                                id: \"timesteps\",\n                                description:\n                                  \"h = horas, m = minutos, s = segundos\",\n                                label: \"Ventana de tiempo\",\n                                \"label-for\": \"timesteps\",\n                              },\n                            },\n                            [\n                              _c(\"b-form-input\", {\n                                attrs: { id: \"timesteps\", placeholder: \"2h\" },\n                                model: {\n                                  value: _vm.timesteps,\n                                  callback: function ($$v) {\n                                    _vm.timesteps = $$v\n                                  },\n                                  expression: \"timesteps\",\n                                },\n                              }),\n                            ],\n                            1\n                          )\n                        : _vm._e(),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"b-card\",\n            { staticClass: \"mb-1 fixed-bottom\", attrs: { \"no-body\": \"\" } },\n            [\n              _c(\n                \"b-card-header\",\n                {\n                  attrs: {\n                    \"header-tag\": \"header\",\n                    role: \"tab\",\n                    \"header-bg-variant\": \"dark\",\n                  },\n                },\n                [\n                  _c(\n                    \"b-button\",\n                    {\n                      attrs: {\n                        block: \"\",\n                        disabled: _vm.add_widget_step > 0 ? false : true,\n                        variant: \"dark\",\n                      },\n                      on: {\n                        click: function () {\n                          this$1.addWidget(\"\", _vm.event, true)\n                        },\n                      },\n                    },\n                    [_vm._v(\"Añadir\\n            \")]\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _c(\n        \"b-row\",\n        [\n          _vm.sidebarToggle == 2\n            ? _c(\"b-col\", {\n                attrs: { cols: _vm.sidebarToggle, id: \"sidebar-wrapper\" },\n              })\n            : _vm._e(),\n          _vm._v(\" \"),\n          _c(\n            \"b-col\",\n            { ref: \"widgets\" },\n            [\n              _c(\n                \"smart-widget-grid\",\n                { attrs: { layout: _vm.layout } },\n                _vm._l(_vm.widgets, function (widget, index) {\n                  return _c(\"Widget\", {\n                    key: widget.gridindex,\n                    attrs: {\n                      slot: widget.gridindex,\n                      gridindex: widget.gridindex,\n                      SignalID: widget.SignalID,\n                      type: widget.type,\n                      params: widget.params,\n                      removeWidget: _vm.removeWidget,\n                      alarm: widget.alarm,\n                    },\n                    slot: widget.gridindex,\n                  })\n                }),\n                1\n              ),\n            ],\n            1\n          ),\n        ],\n        1\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\n          return {\n            render: render,\n            staticRenderFns: staticRenderFns,\n            _compiled: true,\n            _scopeId: \"data-v-b77d75\",\n            functional: undefined\n          };\n        })());\n      \n    /* hot reload */\n    (function () {\n      if (module.hot) {\n        var api = require('vue-hot-reload-api');\n        api.install(require('vue'));\n        if (api.compatible) {\n          module.hot.accept();\n          if (!module.hot.data) {\n            api.createRecord('$b77d75', $b77d75);\n          } else {\n            api.reload('$b77d75', $b77d75);\n          }\n        }\n\n        \n        var reloadCSS = require('_css_loader');\n        module.hot.dispose(reloadCSS);\n        module.hot.accept(reloadCSS);\n      \n      }\n    })();","css":"#toggle-sidebar[data-v-b77d75] {\n  margin-top: 400px !important;\n  height: 100px;\n  /* display: none; */\n}\n\n/* #sidebar-wrapper:hover {\n  background-color: green;\n  height: 100%;\n} */\n/* \n#sidebar-wrapper:hover #toggle-sidebar {\n  display: block !important;\n} */\n.b-list-group[data-v-b77d75] {\n  max-height: 300px !important;\n  margin-bottom: 10px !important;\n  overflow: scroll !important;\n  -webkit-overflow-scrolling: touch !important;\n}\n[data-v-b77d75] .b-sidebar {\n  z-index: 50;\n  margin-top: 70px;\n  height: 93%;\n}"},"sourceMaps":null,"error":null,"hash":"a1c11cb1dffdfbaf5fe0112571badc32","cacheData":{"env":{}}}